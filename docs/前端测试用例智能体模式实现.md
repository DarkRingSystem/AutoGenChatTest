# ğŸ‰ å‰ç«¯æµ‹è¯•ç”¨ä¾‹æ™ºèƒ½ä½“æ¨¡å¼å®ç°å®Œæˆï¼

## âœ… å®Œæˆå†…å®¹

åœ¨å‰ç«¯æ·»åŠ äº†ä¸€ä¸ªå…¥å£ï¼Œå¯ä»¥åˆ‡æ¢åˆ° `TestCasesTeamAIService` å¯¹è¯æ¨¡å¼ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡ç‚¹å‡»"æµ‹è¯•ç”¨ä¾‹æ™ºèƒ½ä½“"æŒ‰é’®æ¥å¯ç”¨å›¢é˜Ÿæ¨¡å¼ï¼Œä¸å¯ç”¨åˆ™ä½¿ç”¨æ™®é€šçš„ `AIService` æ¨¡å¼è¿›è¡Œå¯¹è¯ã€‚

---

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### 1. **æ¨¡å¼åˆ‡æ¢**
- âœ… æ™®é€šå¯¹è¯æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
- âœ… æµ‹è¯•ç”¨ä¾‹æ™ºèƒ½ä½“æ¨¡å¼ï¼ˆå¯åˆ‡æ¢ï¼‰
- âœ… æ¨¡å¼åˆ‡æ¢æŒ‰é’®å¸¦æœ‰è§†è§‰æŒ‡ç¤º
- âœ… åˆ‡æ¢æ—¶æœ‰æç¤ºæ¶ˆæ¯

### 2. **æ™ºèƒ½æç¤º**
- âœ… ä¸åŒæ¨¡å¼æ˜¾ç¤ºä¸åŒçš„å»ºè®®å¡ç‰‡
- âœ… æ™®é€šæ¨¡å¼ï¼šé€šç”¨é—®é¢˜å»ºè®®
- âœ… å›¢é˜Ÿæ¨¡å¼ï¼šæµ‹è¯•ç”¨ä¾‹ç”Ÿæˆå»ºè®®

### 3. **è§†è§‰åé¦ˆ**
- âœ… å›¢é˜Ÿæ¨¡å¼æ¿€æ´»æ—¶æŒ‰é’®é«˜äº®
- âœ… ç»¿è‰²å¾½ç« æŒ‡ç¤ºå™¨
- âœ… æ¬¢è¿ç•Œé¢æ ¹æ®æ¨¡å¼å˜åŒ–
- âœ… å›¾æ ‡å’Œæ–‡æ¡ˆåŠ¨æ€åˆ‡æ¢

---

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

### 1. **frontend/src/App.jsx**

#### æ–°å¢å¯¼å…¥
```javascript
import { Badge } from 'antd';
import { ExperimentOutlined, TeamOutlined } from '@ant-design/icons';
```

#### æ–°å¢çŠ¶æ€
```javascript
const [isTeamMode, setIsTeamMode] = useState(false); // æ˜¯å¦å¯ç”¨æµ‹è¯•ç”¨ä¾‹æ™ºèƒ½ä½“æ¨¡å¼
```

#### æ–°å¢å»ºè®®å¡ç‰‡
```javascript
// æµ‹è¯•ç”¨ä¾‹æ¨¡å¼å»ºè®®æç¤ºå¡ç‰‡
const TESTCASE_SUGGESTIONS = [
  {
    icon: <ExperimentOutlined />,
    text: 'ä¸ºç”¨æˆ·ç™»å½•åŠŸèƒ½ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹',
    gradient: 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)',
    emoji: 'ğŸ”'
  },
  {
    icon: <FileTextOutlined />,
    text: 'ä¸ºè´­ç‰©è½¦æ·»åŠ å•†å“åŠŸèƒ½ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹',
    gradient: 'linear-gradient(135deg, #30cfd0 0%, #330867 100%)',
    emoji: 'ğŸ›’'
  },
  {
    icon: <CodeOutlined />,
    text: 'ä¸ºæ”¯ä»˜æ¥å£ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹',
    gradient: 'linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)',
    emoji: 'ğŸ’³'
  },
];
```

#### API ç«¯ç‚¹é€‰æ‹©
```javascript
// æ ¹æ®æ¨¡å¼é€‰æ‹©ä¸åŒçš„ API ç«¯ç‚¹
const endpoint = isTeamMode 
  ? `${API_BASE_URL}/api/team-chat/stream`
  : `${API_BASE_URL}/api/chat/stream`;
```

#### æ¨¡å¼åˆ‡æ¢å‡½æ•°
```javascript
const toggleTeamMode = () => {
  if (messages.length > 0) {
    antMessage.warning('è¯·å…ˆæ¸…ç©ºå¯¹è¯å†åˆ‡æ¢æ¨¡å¼');
    return;
  }
  setIsTeamMode(!isTeamMode);
  antMessage.success(isTeamMode ? 'å·²åˆ‡æ¢åˆ°æ™®é€šå¯¹è¯æ¨¡å¼' : 'å·²åˆ‡æ¢åˆ°æµ‹è¯•ç”¨ä¾‹æ™ºèƒ½ä½“æ¨¡å¼');
};
```

#### Header ä¸­çš„åˆ‡æ¢æŒ‰é’®
```jsx
<Badge dot={isTeamMode} color="#52c41a">
  <motion.button
    className={`icon-button ${isTeamMode ? 'team-mode-active' : ''}`}
    onClick={toggleTeamMode}
    whileHover={{ scale: 1.1 }}
    whileTap={{ scale: 0.95 }}
    title={isTeamMode ? 'æµ‹è¯•ç”¨ä¾‹æ™ºèƒ½ä½“æ¨¡å¼ï¼ˆç‚¹å‡»åˆ‡æ¢ï¼‰' : 'æ™®é€šå¯¹è¯æ¨¡å¼ï¼ˆç‚¹å‡»åˆ‡æ¢ï¼‰'}
  >
    <TeamOutlined />
  </motion.button>
</Badge>
```

#### æ¬¢è¿ç•Œé¢åŠ¨æ€å†…å®¹
```jsx
{isTeamMode ? <TeamOutlined /> : <RocketOutlined />}

{isTeamMode ? 'ğŸ§ª æµ‹è¯•ç”¨ä¾‹æ™ºèƒ½ä½“å›¢é˜Ÿ' : 'ä½ å¥½ï¼æˆ‘æ˜¯ DeepSeek AI åŠ©æ‰‹'}

{isTeamMode 
  ? 'ç”± 3 ä¸ªä¸“ä¸šæ™ºèƒ½ä½“åä½œï¼Œä¸ºæ‚¨ç”Ÿæˆé«˜è´¨é‡çš„æµ‹è¯•ç”¨ä¾‹'
  : 'æˆ‘å¯ä»¥å¸®ä½ è§£ç­”é—®é¢˜ã€ç¼–å†™ä»£ç ã€åˆ›ä½œå†…å®¹ç­‰ç­‰'
}
```

#### å»ºè®®å¡ç‰‡åŠ¨æ€æ˜¾ç¤º
```jsx
{(isTeamMode ? TESTCASE_SUGGESTIONS : SUGGESTIONS).map((suggestion, index) => (
  // ...
))}
```

---

### 2. **frontend/src/App.css**

#### å›¢é˜Ÿæ¨¡å¼æ¿€æ´»æ ·å¼
```css
/* å›¢é˜Ÿæ¨¡å¼æ¿€æ´»çŠ¶æ€ */
.icon-button.team-mode-active {
  background: linear-gradient(135deg, #52c41a 0%, #73d13d 100%);
  color: white;
  box-shadow: 0 4px 12px rgba(82, 196, 26, 0.4);
}

.icon-button.team-mode-active:hover {
  background: linear-gradient(135deg, #73d13d 0%, #95de64 100%);
  box-shadow: 0 6px 16px rgba(82, 196, 26, 0.5);
}
```

---

### 3. **backend/api/routes.py**

#### æ–°å¢å›¢é˜Ÿæ¨¡å¼ç«¯ç‚¹
```python
@router.post("/api/team-chat/stream")
async def team_chat_stream(request: ChatRequest):
    """
    æµ‹è¯•ç”¨ä¾‹å›¢é˜Ÿæ¨¡å¼çš„æµå¼èŠå¤©å“åº”
    """
    if not request.message:
        raise HTTPException(status_code=400, detail="æ¶ˆæ¯ä¸èƒ½ä¸ºç©º")
    
    # å¯¼å…¥å›¢é˜ŸæœåŠ¡
    from services.ai_service import TestCasesTeamAIService
    from config import settings
    
    # åˆ›å»ºå›¢é˜ŸæœåŠ¡å®ä¾‹
    team_service = TestCasesTeamAIService(settings)
    
    try:
        # åˆå§‹åŒ–å›¢é˜Ÿ
        await team_service.initialize()
        
        # è·å–æµæœåŠ¡
        stream_service = get_stream_service()
        
        # ä»å›¢é˜Ÿè·å–äº‹ä»¶æµ
        async def get_event_stream():
            async for event in team_service.run_stream(task=request.message):
                yield event
        
        # å¤„ç†æµå¼å“åº”
        sse_stream = stream_service.process_stream(get_event_stream(), request.message)
        
        return StreamingResponse(
            sse_stream,
            media_type="text/event-stream",
            headers={
                "Cache-Control": "no-cache",
                "Connection": "keep-alive",
                "X-Accel-Buffering": "no",
                "X-Team-Mode": "true",  # æ ‡è®°ä¸ºå›¢é˜Ÿæ¨¡å¼
            }
        )
    finally:
        # æ¸…ç†å›¢é˜Ÿèµ„æº
        await team_service.cleanup()
```

---

## ğŸ¨ UI è®¾è®¡

### æ¨¡å¼åˆ‡æ¢æŒ‰é’®

#### æ™®é€šæ¨¡å¼
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ   â˜€ï¸  ğŸ—‘ï¸                 â”‚
â”‚  â†‘                          â”‚
â”‚  å›¢é˜Ÿå›¾æ ‡ï¼ˆç°è‰²ï¼‰            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å›¢é˜Ÿæ¨¡å¼æ¿€æ´»
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ â— â˜€ï¸  ğŸ—‘ï¸                â”‚
â”‚  â†‘                          â”‚
â”‚  å›¢é˜Ÿå›¾æ ‡ï¼ˆç»¿è‰²æ¸å˜+å¾½ç« ï¼‰   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### æ¬¢è¿ç•Œé¢

#### æ™®é€šæ¨¡å¼
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ğŸš€                     â”‚
â”‚                                 â”‚
â”‚  ä½ å¥½ï¼æˆ‘æ˜¯ DeepSeek AI åŠ©æ‰‹    â”‚
â”‚                                 â”‚
â”‚  æˆ‘å¯ä»¥å¸®ä½ è§£ç­”é—®é¢˜ã€ç¼–å†™ä»£ç ... â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ âš¡  â”‚ â”‚ ğŸ’¡  â”‚ â”‚ ğŸ’»  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å›¢é˜Ÿæ¨¡å¼
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ğŸ‘¥                     â”‚
â”‚                                 â”‚
â”‚  ğŸ§ª æµ‹è¯•ç”¨ä¾‹æ™ºèƒ½ä½“å›¢é˜Ÿ          â”‚
â”‚                                 â”‚
â”‚  ç”± 3 ä¸ªä¸“ä¸šæ™ºèƒ½ä½“åä½œï¼Œä¸ºæ‚¨ç”Ÿæˆ â”‚
â”‚  é«˜è´¨é‡çš„æµ‹è¯•ç”¨ä¾‹               â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ ğŸ”  â”‚ â”‚ ğŸ›’  â”‚ â”‚ ğŸ’³  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ å·¥ä½œæµç¨‹

### ç”¨æˆ·æ“ä½œæµç¨‹

```
1. æ‰“å¼€åº”ç”¨
   â†“
2. ç‚¹å‡»å›¢é˜Ÿå›¾æ ‡æŒ‰é’®
   â†“
3. çœ‹åˆ°æç¤ºï¼š"å·²åˆ‡æ¢åˆ°æµ‹è¯•ç”¨ä¾‹æ™ºèƒ½ä½“æ¨¡å¼"
   â†“
4. æ¬¢è¿ç•Œé¢å˜åŒ–
   - å›¾æ ‡ï¼šğŸš€ â†’ ğŸ‘¥
   - æ ‡é¢˜ï¼šæ™®é€šåŠ©æ‰‹ â†’ æµ‹è¯•ç”¨ä¾‹æ™ºèƒ½ä½“å›¢é˜Ÿ
   - å»ºè®®å¡ç‰‡ï¼šé€šç”¨é—®é¢˜ â†’ æµ‹è¯•ç”¨ä¾‹åœºæ™¯
   â†“
5. ç‚¹å‡»å»ºè®®æˆ–è¾“å…¥æµ‹è¯•ç”¨ä¾‹éœ€æ±‚
   â†“
6. åç«¯è°ƒç”¨ TestCasesTeamAIService
   - TestCase_Generator ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹
   - TestCase_Reviewer è¯„å®¡
   - TestCase_Optimizer ä¼˜åŒ–
   â†“
7. æµå¼è¿”å›é«˜è´¨é‡æµ‹è¯•ç”¨ä¾‹
```

---

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1: åˆ‡æ¢åˆ°å›¢é˜Ÿæ¨¡å¼

1. **ç‚¹å‡»å›¢é˜Ÿå›¾æ ‡æŒ‰é’®**
   - æŒ‰é’®å˜ä¸ºç»¿è‰²æ¸å˜
   - æ˜¾ç¤ºç»¿è‰²å¾½ç« 
   - æç¤ºï¼š"å·²åˆ‡æ¢åˆ°æµ‹è¯•ç”¨ä¾‹æ™ºèƒ½ä½“æ¨¡å¼"

2. **æŸ¥çœ‹æ¬¢è¿ç•Œé¢**
   - æ ‡é¢˜ï¼šğŸ§ª æµ‹è¯•ç”¨ä¾‹æ™ºèƒ½ä½“å›¢é˜Ÿ
   - å‰¯æ ‡é¢˜ï¼šç”± 3 ä¸ªä¸“ä¸šæ™ºèƒ½ä½“åä½œ...
   - å»ºè®®å¡ç‰‡ï¼š
     - ğŸ” ä¸ºç”¨æˆ·ç™»å½•åŠŸèƒ½ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹
     - ğŸ›’ ä¸ºè´­ç‰©è½¦æ·»åŠ å•†å“åŠŸèƒ½ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹
     - ğŸ’³ ä¸ºæ”¯ä»˜æ¥å£ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹

3. **ç‚¹å‡»å»ºè®®å¡ç‰‡**
   - è‡ªåŠ¨å‘é€ï¼š"ä¸ºç”¨æˆ·ç™»å½•åŠŸèƒ½ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹"
   - åç«¯å›¢é˜Ÿåä½œç”Ÿæˆæµ‹è¯•ç”¨ä¾‹
   - æµå¼æ˜¾ç¤ºç”Ÿæˆè¿‡ç¨‹

---

### ç¤ºä¾‹ 2: åˆ‡æ¢å›æ™®é€šæ¨¡å¼

1. **æ¸…ç©ºå¯¹è¯**
   - ç‚¹å‡»æ¸…ç©ºæŒ‰é’®
   - è‡ªåŠ¨é‡ç½®ä¸ºæ™®é€šæ¨¡å¼

2. **æˆ–æ‰‹åŠ¨åˆ‡æ¢**
   - ç‚¹å‡»å›¢é˜Ÿå›¾æ ‡æŒ‰é’®
   - æç¤ºï¼š"å·²åˆ‡æ¢åˆ°æ™®é€šå¯¹è¯æ¨¡å¼"
   - æŒ‰é’®æ¢å¤æ™®é€šæ ·å¼

---

## ğŸ“Š æ¨¡å¼å¯¹æ¯”

| ç‰¹æ€§ | æ™®é€šæ¨¡å¼ | å›¢é˜Ÿæ¨¡å¼ |
|------|---------|---------|
| **å›¾æ ‡** | ğŸš€ | ğŸ‘¥ |
| **æ ‡é¢˜** | DeepSeek AI åŠ©æ‰‹ | æµ‹è¯•ç”¨ä¾‹æ™ºèƒ½ä½“å›¢é˜Ÿ |
| **æ™ºèƒ½ä½“** | 1 ä¸ª | 3 ä¸ªåä½œ |
| **API ç«¯ç‚¹** | `/api/chat/stream` | `/api/team-chat/stream` |
| **å»ºè®®å¡ç‰‡** | é€šç”¨é—®é¢˜ | æµ‹è¯•ç”¨ä¾‹åœºæ™¯ |
| **å“åº”æ—¶é—´** | å¿« âš¡ | è¾ƒæ…¢ ğŸ¢ï¼ˆå¤šè½®åä½œï¼‰ |
| **å›ç­”è´¨é‡** | æ ‡å‡† â­â­â­ | æ›´é«˜ â­â­â­â­â­ |
| **é€‚ç”¨åœºæ™¯** | é€šç”¨å¯¹è¯ | æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆ |

---

## ğŸš€ å¯åŠ¨å’Œæµ‹è¯•

### 1. å¯åŠ¨åç«¯
```bash
cd backend
python main.py
```

### 2. å¯åŠ¨å‰ç«¯
```bash
cd frontend
npm run dev
```

### 3. æµ‹è¯•åŠŸèƒ½

#### æµ‹è¯•æ™®é€šæ¨¡å¼
1. æ‰“å¼€ http://localhost:3000
2. ç‚¹å‡»å»ºè®®å¡ç‰‡æˆ–è¾“å…¥é—®é¢˜
3. æŸ¥çœ‹æ™®é€š AI å›ç­”

#### æµ‹è¯•å›¢é˜Ÿæ¨¡å¼
1. ç‚¹å‡» Header ä¸­çš„å›¢é˜Ÿå›¾æ ‡æŒ‰é’®
2. è§‚å¯Ÿç•Œé¢å˜åŒ–
3. ç‚¹å‡»æµ‹è¯•ç”¨ä¾‹å»ºè®®å¡ç‰‡
4. æŸ¥çœ‹å›¢é˜Ÿåä½œç”Ÿæˆçš„æµ‹è¯•ç”¨ä¾‹

---

## ğŸ¨ è§†è§‰æ•ˆæœ

### æŒ‰é’®çŠ¶æ€

#### æœªæ¿€æ´»
- èƒŒæ™¯ï¼š`rgba(255, 255, 255, 0.1)`
- å›¾æ ‡ï¼šæ™®é€šé¢œè‰²
- æ— å¾½ç« 

#### æ¿€æ´»
- èƒŒæ™¯ï¼š`linear-gradient(135deg, #52c41a 0%, #73d13d 100%)`
- å›¾æ ‡ï¼šç™½è‰²
- ç»¿è‰²å¾½ç« 
- é˜´å½±ï¼š`0 4px 12px rgba(82, 196, 26, 0.4)`

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### çŠ¶æ€ç®¡ç†
```javascript
const [isTeamMode, setIsTeamMode] = useState(false);
```

### ç«¯ç‚¹é€‰æ‹©
```javascript
const endpoint = isTeamMode 
  ? `${API_BASE_URL}/api/team-chat/stream`
  : `${API_BASE_URL}/api/chat/stream`;
```

### æ¨¡å¼åˆ‡æ¢é™åˆ¶
```javascript
if (messages.length > 0) {
  antMessage.warning('è¯·å…ˆæ¸…ç©ºå¯¹è¯å†åˆ‡æ¢æ¨¡å¼');
  return;
}
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **åç«¯å®ç°**: `TestCasesTeamAIServiceé‡å‘½åå®Œæˆ.md`
- **å›¢é˜ŸæœåŠ¡**: `backend/services/ai_service.py`
- **API è·¯ç”±**: `backend/api/routes.py`

---

**å‰ç«¯æµ‹è¯•ç”¨ä¾‹æ™ºèƒ½ä½“æ¨¡å¼å®ç°å®Œæˆï¼ç°åœ¨å¯ä»¥åœ¨å‰ç«¯è½»æ¾åˆ‡æ¢æ™®é€šå¯¹è¯å’Œæµ‹è¯•ç”¨ä¾‹ç”Ÿæˆæ¨¡å¼äº†ï¼** ğŸ‰ğŸ§ª


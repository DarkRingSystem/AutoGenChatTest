# å‰ç«¯ç•Œé¢ä¼˜åŒ–æ€»ç»“

## ğŸ¯ ä¼˜åŒ–ç›®æ ‡

1. **ç»Ÿä¸€å¯¼èˆªæ ** - æ‰€æœ‰é¡µé¢ä½¿ç”¨ç»Ÿä¸€çš„é¡¶éƒ¨å¯¼èˆª
2. **éšè—é‡å¤ Header** - è¿›å…¥åŠŸèƒ½æ¨¡å¼åéšè—åŸæœ‰çš„ header
3. **æ•´åˆåŠŸèƒ½æŒ‰é’®** - å°†æ¸…ç©ºå¯¹è¯ã€ä¸»é¢˜åˆ‡æ¢ç­‰åŠŸèƒ½ç§»åˆ°å¯¼èˆªæ 
4. **æ¡ä»¶æ˜¾ç¤º** - æ¸…ç©ºä¼šè¯æŒ‰é’®ä»…åœ¨åŠŸèƒ½é¡µé¢æ˜¾ç¤º

---

## âœ… å·²å®Œæˆçš„ä¼˜åŒ–

### 1. å¯¼èˆªæ ä¼˜åŒ–

#### ä¹‹å‰
- é¦–é¡µï¼šæ— å¯¼èˆªæ 
- åŠŸèƒ½é¡µé¢ï¼šæ˜¾ç¤ºå¯¼èˆªæ 
- æ¯ä¸ªåŠŸèƒ½é¡µé¢å†…éƒ¨è¿˜æœ‰ç‹¬ç«‹çš„ header

#### ç°åœ¨
- **æ‰€æœ‰é¡µé¢**ï¼šç»Ÿä¸€çš„é¡¶éƒ¨å¯¼èˆªæ 
- **é¦–é¡µ**ï¼šæ˜¾ç¤ºå¯¼èˆªæ ï¼ˆæ— æ¸…ç©ºæŒ‰é’®ï¼‰
- **åŠŸèƒ½é¡µé¢**ï¼šæ˜¾ç¤ºå¯¼èˆªæ ï¼ˆå«æ¸…ç©ºæŒ‰é’®ï¼‰
- **åŠŸèƒ½é¡µé¢å†…éƒ¨**ï¼šéšè—åŸæœ‰ header

### 2. åŠŸèƒ½æŒ‰é’®æ•´åˆ

#### å¯¼èˆªæ æŒ‰é’®å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤– AutoGen Chat  â”‚ é¦–é¡µ æ™®é€šå¯¹è¯ æµ‹è¯•ç”¨ä¾‹ å›¾ç‰‡åˆ†æ â”‚ ğŸ—‘ï¸ â˜€ï¸ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å·¦ä¾§**ï¼šLogo + å“ç‰Œåç§°  
**ä¸­é—´**ï¼šåŠŸèƒ½å¯¼èˆªèœå•  
**å³ä¾§**ï¼šæ“ä½œæŒ‰é’®
- ğŸ—‘ï¸ æ¸…ç©ºå¯¹è¯ï¼ˆä»…åŠŸèƒ½é¡µé¢æ˜¾ç¤ºï¼‰
- â˜€ï¸/ğŸŒ™ ä¸»é¢˜åˆ‡æ¢ï¼ˆæ‰€æœ‰é¡µé¢æ˜¾ç¤ºï¼‰

### 3. æ¸…ç©ºä¼šè¯æœºåˆ¶

#### å®ç°æ–¹å¼

```javascript
// MainLayout.jsx
const clearSessionRef = useRef(null);

const registerClearSession = (callback) => {
  clearSessionRef.current = callback;
};

const handleClearSession = () => {
  if (clearSessionRef.current) {
    clearSessionRef.current();
  }
};

// ä¼ é€’ç»™å­ç»„ä»¶
<Outlet context={{ isDark, toggleTheme, registerClearSession }} />
```

#### æ³¨å†Œæµç¨‹

```
MainLayout
    â†“ (registerClearSession)
ChatNormalPage
    â†“ (registerClearSession)
ChatNormalContainer
    â†“ (registerClearSession)
LegacyApp
    â†“ (useEffect æ³¨å†Œ)
handleClear å‡½æ•°
```

---

## ğŸ“Š ç•Œé¢å¯¹æ¯”

### é¦–é¡µ

#### ä¹‹å‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                     â”‚
â”‚         æ¨¡å¼é€‰æ‹©å¡ç‰‡                 â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ç°åœ¨
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤– AutoGen Chat â”‚ é¦–é¡µ ... â”‚ â˜€ï¸    â”‚ â† å¯¼èˆªæ 
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚         æ¨¡å¼é€‰æ‹©å¡ç‰‡                 â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ™®é€šå¯¹è¯é¡µé¢

#### ä¹‹å‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤– AutoGen Chat â”‚ é¦–é¡µ ... â”‚ â˜€ï¸    â”‚ â† å¯¼èˆªæ 
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”¥ DeepSeek AI        â”‚ ğŸ  â˜€ï¸ ğŸ—‘ï¸  â”‚ â† åŸæœ‰ header
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚         èŠå¤©ç•Œé¢                     â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ç°åœ¨
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤– AutoGen Chat â”‚ é¦–é¡µ ... â”‚ ğŸ—‘ï¸ â˜€ï¸ â”‚ â† å¯¼èˆªæ ï¼ˆæ•´åˆåŠŸèƒ½ï¼‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚         èŠå¤©ç•Œé¢                     â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. MainLayout ç»„ä»¶

**æ–°å¢åŠŸèƒ½**:
- `clearSessionRef` - å­˜å‚¨æ¸…ç©ºä¼šè¯çš„å›è°ƒå‡½æ•°
- `registerClearSession()` - æ³¨å†Œæ¸…ç©ºä¼šè¯å›è°ƒ
- `handleClearSession()` - æ‰§è¡Œæ¸…ç©ºä¼šè¯
- `isInModePage` - åˆ¤æ–­æ˜¯å¦åœ¨åŠŸèƒ½é¡µé¢

**æŒ‰é’®æ˜¾ç¤ºé€»è¾‘**:
```javascript
{isInModePage && (
  <Tooltip title="æ¸…ç©ºå¯¹è¯">
    <Button
      type="text"
      icon={<ClearOutlined />}
      onClick={handleClearSession}
    />
  </Tooltip>
)}
```

### 2. LegacyApp ç»„ä»¶

**æ–°å¢ Props**:
- `registerClearSession` - æ³¨å†Œæ¸…ç©ºä¼šè¯çš„å›è°ƒ
- `hideHeader` - æ˜¯å¦éšè—åŸæœ‰ header

**æ³¨å†Œé€»è¾‘**:
```javascript
useEffect(() => {
  if (registerClearSession) {
    registerClearSession(() => {
      setMessages([]);
      setConversationId(null);
      message.success('å¯¹è¯å·²æ¸…ç©º');
    });
  }
}, [registerClearSession, setMessages, setConversationId]);
```

**éšè— Header**:
```javascript
{!hideHeader && (
  <motion.header className="app-header">
    {/* header å†…å®¹ */}
  </motion.header>
)}
```

### 3. å®¹å™¨ç»„ä»¶

**ChatNormalContainer.jsx**:
```javascript
export default function ChatNormalContainer({ isDark, registerClearSession }) {
  return (
    <LegacyApp 
      initialMode="normal" 
      isDark={isDark}
      registerClearSession={registerClearSession}
      hideHeader={true}  // éšè—åŸæœ‰ header
    />
  );
}
```

### 4. é¡µé¢ç»„ä»¶

**ChatNormalPage.jsx**:
```javascript
export default function ChatNormalPage() {
  const { isDark, registerClearSession } = useOutletContext();
  
  return (
    <ChatNormalContainer 
      isDark={isDark} 
      registerClearSession={registerClearSession}
    />
  );
}
```

---

## ğŸ¨ æ ·å¼ä¼˜åŒ–

### æ–°å¢æ ·å¼

```css
.action-button {
  color: rgba(255, 255, 255, 0.85);
  font-size: 18px;
  transition: all 0.3s ease;
}

.action-button:hover {
  color: #00b96b;
  transform: scale(1.1);
}

.main-layout.light .action-button {
  color: rgba(0, 0, 0, 0.85);
}
```

---

## ğŸ“ˆ ç”¨æˆ·ä½“éªŒæå‡

### ä¼˜åŠ¿

âœ… **ç»Ÿä¸€æ€§** - æ‰€æœ‰é¡µé¢ä½¿ç”¨ç»Ÿä¸€çš„å¯¼èˆªæ   
âœ… **ç®€æ´æ€§** - ç§»é™¤é‡å¤çš„ headerï¼Œç•Œé¢æ›´ç®€æ´  
âœ… **ä¸€è‡´æ€§** - åŠŸèƒ½æŒ‰é’®ä½ç½®å›ºå®šï¼Œæ“ä½œæ›´ç›´è§‚  
âœ… **æ™ºèƒ½æ€§** - æ¸…ç©ºæŒ‰é’®ä»…åœ¨éœ€è¦æ—¶æ˜¾ç¤º  

### äº¤äº’æ”¹è¿›

| åŠŸèƒ½ | ä¹‹å‰ | ç°åœ¨ |
|------|------|------|
| åˆ‡æ¢æ¨¡å¼ | ç‚¹å‡»å¯¼èˆªèœå• | ç‚¹å‡»å¯¼èˆªèœå• |
| æ¸…ç©ºå¯¹è¯ | ç‚¹å‡»é¡µé¢å†… header æŒ‰é’® | ç‚¹å‡»å¯¼èˆªæ æŒ‰é’® |
| ä¸»é¢˜åˆ‡æ¢ | ç‚¹å‡»é¡µé¢å†… header æŒ‰é’® | ç‚¹å‡»å¯¼èˆªæ æŒ‰é’® |
| è¿”å›é¦–é¡µ | ç‚¹å‡»é¡µé¢å†… header æŒ‰é’® | ç‚¹å‡»å¯¼èˆªèœå•"é¦–é¡µ" |

---

## ğŸ”„ æ•°æ®æµ

### æ¸…ç©ºä¼šè¯æ•°æ®æµ

```
ç”¨æˆ·ç‚¹å‡»æ¸…ç©ºæŒ‰é’®
    â†“
MainLayout.handleClearSession()
    â†“
clearSessionRef.current()
    â†“
LegacyApp æ³¨å†Œçš„å›è°ƒå‡½æ•°
    â†“
setMessages([])
setConversationId(null)
message.success('å¯¹è¯å·²æ¸…ç©º')
```

### Props ä¼ é€’æµç¨‹

```
MainLayout
  â”œâ”€ isDark (state)
  â”œâ”€ toggleTheme (function)
  â””â”€ registerClearSession (function)
      â†“ (via Outlet context)
ChatNormalPage
  â”œâ”€ isDark
  â””â”€ registerClearSession
      â†“ (via props)
ChatNormalContainer
  â”œâ”€ isDark
  â””â”€ registerClearSession
      â†“ (via props)
LegacyApp
  â”œâ”€ isDark (sync to internal state)
  â”œâ”€ registerClearSession (register callback)
  â””â”€ hideHeader (hide original header)
```

---

## âœ… éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½æµ‹è¯•

- [x] é¦–é¡µæ˜¾ç¤ºå¯¼èˆªæ 
- [x] é¦–é¡µä¸æ˜¾ç¤ºæ¸…ç©ºæŒ‰é’®
- [x] åŠŸèƒ½é¡µé¢æ˜¾ç¤ºå¯¼èˆªæ 
- [x] åŠŸèƒ½é¡µé¢æ˜¾ç¤ºæ¸…ç©ºæŒ‰é’®
- [x] åŠŸèƒ½é¡µé¢éšè—åŸæœ‰ header
- [x] æ¸…ç©ºæŒ‰é’®æ­£å¸¸å·¥ä½œ
- [x] ä¸»é¢˜åˆ‡æ¢æ­£å¸¸å·¥ä½œ
- [x] å¯¼èˆªèœå•æ­£å¸¸å·¥ä½œ

### è§†è§‰æµ‹è¯•

- [x] å¯¼èˆªæ æ ·å¼ç»Ÿä¸€
- [x] æŒ‰é’®å›¾æ ‡æ¸…æ™°
- [x] æ‚¬åœæ•ˆæœæµç•…
- [x] æ·±è‰²/æµ…è‰²ä¸»é¢˜é€‚é…
- [x] å“åº”å¼å¸ƒå±€æ­£å¸¸

### äº¤äº’æµ‹è¯•

- [x] ç‚¹å‡»æ¸…ç©ºæŒ‰é’®æ¸…ç©ºå¯¹è¯
- [x] ç‚¹å‡»ä¸»é¢˜æŒ‰é’®åˆ‡æ¢ä¸»é¢˜
- [x] ç‚¹å‡»èœå•é¡¹åˆ‡æ¢é¡µé¢
- [x] æŒ‰é’®ç¦ç”¨çŠ¶æ€æ­£ç¡®
- [x] æç¤ºä¿¡æ¯æ­£ç¡®æ˜¾ç¤º

---

## ğŸ“ åç»­ä¼˜åŒ–å»ºè®®

### çŸ­æœŸä¼˜åŒ–

1. **æ·»åŠ å¿«æ·é”®**
   - `Ctrl/Cmd + K` - æ¸…ç©ºå¯¹è¯
   - `Ctrl/Cmd + D` - åˆ‡æ¢ä¸»é¢˜

2. **æ·»åŠ ç¡®è®¤å¯¹è¯æ¡†**
   - æ¸…ç©ºå¯¹è¯å‰å¼¹å‡ºç¡®è®¤æ¡†
   - é˜²æ­¢è¯¯æ“ä½œ

3. **æ·»åŠ åŠ¨ç”»æ•ˆæœ**
   - æŒ‰é’®ç‚¹å‡»åŠ¨ç”»
   - é¡µé¢åˆ‡æ¢è¿‡æ¸¡

### ä¸­æœŸä¼˜åŒ–

1. **å“åº”å¼ä¼˜åŒ–**
   - ç§»åŠ¨ç«¯é€‚é…
   - å°å±å¹•å¸ƒå±€ä¼˜åŒ–

2. **æ— éšœç¢ä¼˜åŒ–**
   - æ·»åŠ  ARIA æ ‡ç­¾
   - é”®ç›˜å¯¼èˆªæ”¯æŒ

3. **æ€§èƒ½ä¼˜åŒ–**
   - æŒ‰é’®é˜²æŠ–
   - å‡å°‘é‡æ¸²æŸ“

---

## ğŸ“š ç›¸å…³æ–‡ä»¶

### ä¿®æ”¹çš„æ–‡ä»¶

- `frontend/src/components/layout/MainLayout.jsx` - ä¸»å¸ƒå±€ç»„ä»¶
- `frontend/src/components/layout/MainLayout.css` - ä¸»å¸ƒå±€æ ·å¼
- `frontend/src/components/LegacyApp.jsx` - åŸåº”ç”¨ç»„ä»¶
- `frontend/src/components/chat/ChatNormalContainer.jsx` - æ™®é€šå¯¹è¯å®¹å™¨
- `frontend/src/components/chat/ChatTestCaseContainer.jsx` - æµ‹è¯•ç”¨ä¾‹å®¹å™¨
- `frontend/src/pages/ChatNormalPage.jsx` - æ™®é€šå¯¹è¯é¡µé¢
- `frontend/src/pages/ChatTestCasePage.jsx` - æµ‹è¯•ç”¨ä¾‹é¡µé¢

---

## ğŸ‰ æ€»ç»“

é€šè¿‡è¿™æ¬¡ä¼˜åŒ–ï¼Œæˆ‘ä»¬å®ç°äº†ï¼š

âœ… **ç»Ÿä¸€çš„å¯¼èˆªä½“éªŒ** - æ‰€æœ‰é¡µé¢ä½¿ç”¨ç»Ÿä¸€çš„é¡¶éƒ¨å¯¼èˆªæ   
âœ… **ç®€æ´çš„ç•Œé¢è®¾è®¡** - ç§»é™¤é‡å¤çš„ headerï¼Œç•Œé¢æ›´åŠ ç®€æ´  
âœ… **æ™ºèƒ½çš„åŠŸèƒ½æ˜¾ç¤º** - æ¸…ç©ºæŒ‰é’®ä»…åœ¨éœ€è¦æ—¶æ˜¾ç¤º  
âœ… **æµç•…çš„äº¤äº’ä½“éªŒ** - åŠŸèƒ½æŒ‰é’®ä½ç½®å›ºå®šï¼Œæ“ä½œæ›´åŠ ä¾¿æ·  

**ç”¨æˆ·ä½“éªŒæå‡**: â­â­â­â­â­  
**ä»£ç è´¨é‡æå‡**: â­â­â­â­â­  
**ç»´æŠ¤æ€§æå‡**: â­â­â­â­â­  

---

**ä¼˜åŒ–å®Œæˆæ—¶é—´**: 2025-10-09  
**ç‰ˆæœ¬**: v2.1.0  
**çŠ¶æ€**: âœ… å·²å®Œæˆ

